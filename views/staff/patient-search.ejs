<!DOCTYPE html>
<html>
<head>
    <title>Patient Search</title>
    <link rel="stylesheet" href="/styles.css">
</head>

<body>

<header>
    <h1>Search Patients</h1>
    <nav>
        <a href="/staff/dashboard">Dashboard</a>
        <a href="/staff/appointments">Appointments</a>
        <a href="/auth/logout">Logout</a>
    </nav>
</header>

<main>

    <% if (error) { %>
        <div class="error-box"><%= error %></div>
    <% } %>

    <p class="page-description">
        Use this form to search for a patient by entering any known details such as their name, email, phone number, or keywords in their notes. You can fill in one or multiple fields to help locate a patient record.
    </p>


    <form method="POST" action="/staff/patient-search" class="search-form">

        <label>First Name</label>
        <input type="text" name="first_name">

        <label>Last Name</label>
        <input type="text" name="last_name">

        <label>Email</label>
        <input type="text" name="email">

        <label>Phone</label>
        <input type="text" name="phone">

        <label>Keyword in Notes</label>
        <input type="text" name="notes">

        <button type="submit" class="btn">Search</button>
    </form>

    <hr>

    <% if (results && results.length > 0) { %>

        <h2>Search Results</h2>
        <table>
            <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Phone</th>
                <th>Notes</th>
                <th>Update Notes</th>
            </tr>

            <% results.forEach(patient => { %>
                <tr>
                    <td><%= patient.first_name %> <%= patient.last_name %></td>
                    <td><%= patient.email || "—" %></td>
                    <td><%= patient.phone || "—" %></td>
                    <td><%= patient.notes || "—" %></td>
                    <td>
                        <a href="/staff/patients/<%= patient.id %>" class="btn">Edit</a>
                    </td>
                </tr>
            <% }) %>

        </table>

    <% } else if (results && results.length === 0) { %>

        <p>No matching patients found.</p>

    <% } %>

</main>

</body>
</html>
